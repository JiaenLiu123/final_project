2023-01-23 14:43:23,839:ERROR:local variable 'i' referenced before assignment
2023-01-23 14:47:26,900:ERROR:local variable 'i' referenced before assignment
2023-01-23 14:48:11,850:ERROR:local variable 'i' referenced before assignment
2023-01-23 14:48:47,548:ERROR:local variable 'i' referenced before assignment
2023-01-23 16:48:50,228:ERROR:Can only use .str accessor with string values!
2023-01-26 17:12:27,320:ERROR:'NoneType' object is not iterable
2023-01-26 17:13:13,345:ERROR:'NoneType' object is not iterable
2023-01-26 17:23:38,037:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-01-26 17:26:26,460:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 08:46:48,393:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 08:50:35,471:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 08:53:07,415:ERROR:object of type 'generator' has no len()
2023-02-06 08:55:54,956:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 09:17:24,416:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 09:44:13,390:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 3.53 GiB free; 2.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 09:47:56,645:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 3.53 GiB free; 2.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 09:51:23,585:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 3.53 GiB free; 2.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 09:57:17,194:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 3.53 GiB free; 2.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 09:59:55,488:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 3.53 GiB free; 2.48 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 10:02:15,458:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 4.47 GiB free; 1.54 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 10:04:27,883:ERROR:[Errno 2] No such file or directory: 'output_img/362_inference.jpg'
2023-02-06 10:11:52,417:ERROR:CUDA out of memory. Tried to allocate 5.99 GiB (GPU 0; 8.00 GiB total capacity; 1.49 GiB already allocated; 4.47 GiB free; 1.54 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
2023-02-06 10:18:45,979:ERROR:local variable 'predictions' referenced before assignment
2023-02-06 10:31:53,621:ERROR:Can only use .str accessor with string values!
2023-02-06 10:41:43,690:ERROR:Can only use .str accessor with string values!
2023-02-06 10:41:43,694:ERROR:Traceback (most recent call last):
  File "test_handler.py", line 31, in <module>
    inference_batch = prepare_batch_for_inference(batch)
  File "/home/student/final_project/layoutLM/ocr.py", line 56, in prepare_batch_for_inference
    clean_outputs = [run_and_clean_tesseract_on_image(image_path) for image_path in image_paths]
  File "/home/student/final_project/layoutLM/ocr.py", line 56, in <listcomp>
    clean_outputs = [run_and_clean_tesseract_on_image(image_path) for image_path in image_paths]
  File "/home/student/final_project/layoutLM/ocr.py", line 23, in run_and_clean_tesseract_on_image
    ocr_df = ocr_df.drop(ocr_df[ocr_df.text.str.strip() == ''].index)
  File "/home/student/miniconda3/envs/py38/lib/python3.8/site-packages/pandas/core/generic.py", line 5902, in __getattr__
    return object.__getattribute__(self, name)
  File "/home/student/miniconda3/envs/py38/lib/python3.8/site-packages/pandas/core/accessor.py", line 182, in __get__
    accessor_obj = self._accessor(obj)
  File "/home/student/miniconda3/envs/py38/lib/python3.8/site-packages/pandas/core/strings/accessor.py", line 181, in __init__
    self._inferred_dtype = self._validate(data)
  File "/home/student/miniconda3/envs/py38/lib/python3.8/site-packages/pandas/core/strings/accessor.py", line 235, in _validate
    raise AttributeError("Can only use .str accessor with string values!")
AttributeError: Can only use .str accessor with string values!

2023-02-06 15:07:12,569:ERROR:[Errno 2] No such file or directory: '/home/student/T1-train/img'
2023-02-06 15:07:12,569:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 42, in <module>
    image_files = os.listdir(image_path)
FileNotFoundError: [Errno 2] No such file or directory: '/home/student/T1-train/img'

2023-02-06 15:09:23,910:ERROR:[Errno 2] No such file or directory: 'text_output/regex.csv'
2023-02-06 15:09:23,910:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 48, in <module>
    run_and_clean_tesseract_on_image(file)
  File "test_all_images.py", line 34, in run_and_clean_tesseract_on_image
    with open("text_output/regex.csv") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'text_output/regex.csv'

2023-02-06 15:09:59,890:ERROR:[Errno 2] No such file or directory: 'text_output/regex.csv'
2023-02-06 15:09:59,890:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 49, in <module>
    run_and_clean_tesseract_on_image(file)
  File "test_all_images.py", line 35, in run_and_clean_tesseract_on_image
    with open("text_output/regex.csv") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'text_output/regex.csv'

2023-02-06 15:11:01,553:ERROR:[Errno 2] No such file or directory: 'text_output/regex.csv'
2023-02-06 15:11:01,554:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 51, in <module>
    run_and_clean_tesseract_on_image(file)
  File "test_all_images.py", line 35, in run_and_clean_tesseract_on_image
    with open("text_output/regex.csv") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'text_output/regex.csv'

2023-02-06 15:11:28,665:ERROR:[Errno 2] No such file or directory: 'text_output/regex.csv'
2023-02-06 15:11:28,665:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 52, in <module>
    run_and_clean_tesseract_on_image(file)
  File "test_all_images.py", line 36, in run_and_clean_tesseract_on_image
    with open("text_output/regex.csv") as f:
FileNotFoundError: [Errno 2] No such file or directory: 'text_output/regex.csv'

2023-02-06 15:12:41,416:ERROR:list index out of range
2023-02-06 15:12:41,417:ERROR:Traceback (most recent call last):
  File "test_all_images.py", line 52, in <module>
    run_and_clean_tesseract_on_image(file)
  File "test_all_images.py", line 32, in run_and_clean_tesseract_on_image
    date, total = test_regex(text)
  File "/Users/liujiaen/Documents/Text_Recognition/final_project/regex_script/test_all_regex.py", line 160, in test_regex
    date = date_scores[0]
IndexError: list index out of range

2023-03-08 14:22:09,675:ERROR:'image'
2023-03-08 14:22:09,675:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 233, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 200, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 74, in preprocess
    image = [inference_dict['image']]
KeyError: 'image'

2023-03-08 14:23:35,933:ERROR:'int' object is not subscriptable
2023-03-08 14:23:35,933:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 233, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 200, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 77, in preprocess
    boxes = [[normalize_box(box, image[i].size[0], image[i].size[1])
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 77, in <listcomp>
    boxes = [[normalize_box(box, image[i].size[0], image[i].size[1])
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 77, in <listcomp>
    boxes = [[normalize_box(box, image[i].size[0], image[i].size[1])
  File "/home/jiaenliu/final_project/layoutLM/utils.py", line 6, in normalize_box
    int(bbox[0]*(1000/width)),
TypeError: 'int' object is not subscriptable

2023-03-08 14:28:50,482:ERROR:list indices must be integers or slices, not str
2023-03-08 14:28:50,483:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 33, in <module>
    inference_batch = prepare_batch_for_inference(test_image)
  File "/home/jiaenliu/final_project/layoutLM/ocr.py", line 60, in prepare_batch_for_inference
    word_lists = [word['word_text'] for word in clean_output]
  File "/home/jiaenliu/final_project/layoutLM/ocr.py", line 60, in <listcomp>
    word_lists = [word['word_text'] for word in clean_output]
TypeError: list indices must be integers or slices, not str

2023-03-08 14:29:52,866:ERROR:'image'
2023-03-08 14:29:52,867:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 233, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 200, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 74, in preprocess
    image = [inference_dict['image']]
KeyError: 'image'

2023-03-08 14:30:27,008:ERROR:'list' object has no attribute 'size'
2023-03-08 14:30:27,008:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 233, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 200, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 75, in preprocess
    self._image_size = [img.size for img in image]
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 75, in <listcomp>
    self._image_size = [img.size for img in image]
AttributeError: 'list' object has no attribute 'size'

2023-03-08 14:32:40,942:ERROR:'list' object has no attribute 'size'
2023-03-08 14:32:40,943:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 236, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 203, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 78, in preprocess
    self._images_size = [img.size for img in images]
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 78, in <listcomp>
    self._images_size = [img.size for img in images]
AttributeError: 'list' object has no attribute 'size'

2023-03-08 14:33:12,772:ERROR:image has wrong mode
2023-03-08 14:33:12,772:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 236, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 212, in handle
    annotate_image(data['images'][i], flattened_output)
  File "/home/jiaenliu/final_project/layoutLM/annotate_image.py", line 48, in annotate_image
    img = Image.alpha_composite(tmp, overlay)
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/PIL/Image.py", line 3207, in alpha_composite
    return im1._new(core.alpha_composite(im1.im, im2.im))
ValueError: image has wrong mode

2023-03-08 14:35:18,399:ERROR:image has wrong mode
2023-03-08 14:35:18,400:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 236, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 212, in handle
    annotate_image(data['images'][i], flattened_output)
  File "/home/jiaenliu/final_project/layoutLM/annotate_image.py", line 48, in annotate_image
    img = Image.alpha_composite(tmp, overlay)
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/PIL/Image.py", line 3207, in alpha_composite
    return im1._new(core.alpha_composite(im1.im, im2.im))
ValueError: image has wrong mode

2023-03-08 14:36:53,530:ERROR:operands could not be broadcast together with shapes (4,224,224) (3,) 
2023-03-08 14:36:53,531:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 236, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 203, in handle
    model_input = self.preprocess(data)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 82, in preprocess
    encoded_inputs = processor(
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/transformers/models/layoutlmv3/processing_layoutlmv3.py", line 94, in __call__
    features = self.feature_extractor(images=images, return_tensors=return_tensors)
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/transformers/models/layoutlmv3/feature_extraction_layoutlmv3.py", line 240, in __call__
    images = [self.normalize(image=image, mean=self.image_mean, std=self.image_std) for image in images]
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/transformers/models/layoutlmv3/feature_extraction_layoutlmv3.py", line 240, in <listcomp>
    images = [self.normalize(image=image, mean=self.image_mean, std=self.image_std) for image in images]
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/site-packages/transformers/image_utils.py", line 351, in normalize
    return (image - mean) / std
ValueError: operands could not be broadcast together with shapes (4,224,224) (3,) 

2023-03-08 14:37:55,049:ERROR:expected str, bytes or os.PathLike object, not Image
2023-03-08 14:37:55,050:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 236, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 212, in handle
    annotate_image(data['images'][i], flattened_output)
  File "/home/jiaenliu/final_project/layoutLM/annotate_image.py", line 52, in annotate_image
    image_name = os.path.basename(image_path)
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/posixpath.py", line 142, in basename
    p = os.fspath(p)
TypeError: expected str, bytes or os.PathLike object, not Image

2023-03-08 14:40:01,321:ERROR:expected str, bytes or os.PathLike object, not Image
2023-03-08 14:40:01,321:ERROR:Traceback (most recent call last):
  File "/home/jiaenliu/final_project/test_handler.py", line 35, in <module>
    handle(inference_batch, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 230, in handle
    return _service.handle(data, context)
  File "/home/jiaenliu/final_project/layoutLM/layoutLMv3.py", line 212, in handle
    img = annotate_image(data['images'][i], flattened_output)
  File "/home/jiaenliu/final_project/layoutLM/annotate_image.py", line 52, in annotate_image
    image_name = os.path.basename(image_path)
  File "/home/jiaenliu/miniconda3/envs/receipt/lib/python3.8/posixpath.py", line 142, in basename
    p = os.fspath(p)
TypeError: expected str, bytes or os.PathLike object, not Image

